= SafetyNet Application Design

== Architecture

[plantuml]
----
@startuml
package fr-swynn {
    class SafetyNetApplication

    package Controller {
        class FirestationController
        class MedicalController
        class PersonController

        SafetyNetApplication <-- FirestationController : Injected by SpringBoot scan package
        SafetyNetApplication <-- MedicalController : Injected by SpringBoot scan package
        SafetyNetApplication <-- PersonController : Injected by SpringBoot scan package
    }

    package Gateway {
        interface GatewayProxy
        interface Gateway

        class GatewayProvider
        class SafetyNetGateway

        FirestationController <-- GatewayProxy : Injected by ServiceLoader
        MedicalController <-- GatewayProxy : Injected by ServiceLoader
        PersonController <-- GatewayProxy : Injected by ServiceLoader

        GatewayProxy <.. GatewayProvider : Implementation

        Gateway <.. SafetyNetGateway : Implementation

        GatewayProvider --* SafetyNetGateway : Return singleton instance
    }

    package Service {
        interface FirestationService
        interface MedicalService
        interface PersonService

        class SafetyNetFirestationService
        class SafetyNetMedicalService
        class SafetyNetPersonService

        SafetyNetGateway <-- FirestationService : Injected by ServiceLoader
        SafetyNetGateway <-- MedicalService : Injected by ServiceLoader
        SafetyNetGateway <-- PersonService : Injected by ServiceLoader

        FirestationService <.. SafetyNetFirestationService : Implementation
        MedicalService <.. SafetyNetMedicalService : Implementation
        PersonService <.. SafetyNetPersonService : Implementation
    }

    package Repository {
        interface JsonRepository
        interface FirestationRepository
        interface MedicalRepository
        interface PersonRepository

        class DefaultJsonRepository
        class DefaultFirestationRepository
        class DefaultMedicalRepository
        class DefaultPersonRepository

        SafetyNetFirestationService <-- FirestationRepository : Injected by ServiceLoader
        SafetyNetMedicalService <-- MedicalRepository : Injected by ServiceLoader
        SafetyNetPersonService <-- PersonRepository : Injected by ServiceLoader

        MedicalRepository <.. DefaultMedicalRepository : Implementation
        PersonRepository <.. DefaultPersonRepository : Implementation
        FirestationRepository <.. DefaultFirestationRepository : Implementation

        DefaultFirestationRepository <-- JsonRepository : Injected by ServiceLoader
        DefaultMedicalRepository <-- JsonRepository : Injected by ServiceLoader
        DefaultPersonRepository <-- JsonRepository : Injected by ServiceLoader

        JsonRepository <.. DefaultJsonRepository : Implementation
    }
}
@enduml
----